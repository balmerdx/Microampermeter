Микроамперметр с диодом.
Заодно является источником питания 



ADP3334 - LDO adjustable https://aliexpress.ru/item/4000185527155.html
TL072 как усилитель перед LDO
AD8221 как дифф усилитель
STM32H750

https://aliexpress.ru/item/33007959640.html  - 10Mohm resistor


Статейка о том, что с 6.8 Ом резистором можно в широком диапазоне измерять.
https://www.ti.com/lit/ug/tidu033/tidu033.pdf?ts=1596393210408&ref_url=https%253A%252F%252Fwww.google.com%252F

Это будет именно блок питания с измерением тока.
Пускай всегда от 220 вольт питается.
Возможность подключать к компьютеру для снятия графиков.
Возможность менять напряжение от 1.2 до 3.3 вольта .

Отображение как тока, так и сопротивления.
Самое главное - график изменения со временем.
Протестируем на конденсаторе, достаточно ли линейная шкала.

Предположим у нас 100 КОм и 12 бит честных есть. 


https://aliexpress.ru/item/4000919520888.html - энкодер, положение которого известно

Сделать совсем простой микро-наноампрметр.
Он должен.

TPS79301 - неплохой LDO
ADP3334 - тоже хороший

ADS127L01 20$ 512 ksps - ему требуется дифференциальный сигнал, отпадает (зато отлично подходит для RLC измерителя!!!)
ads1251 18$ (mouser) 7.7$ (lcsc) - лучше тут две купить, чем в mouser одну

ads1251 - ему требуется 8 МГц clock (это легко устроить)
AD8418 как неплохой zero drift current amplifier
INA213 тоже нормальный, с низким потреблением и уровнем шума
INA213 - 50 раз усиление. 2 вольта будет при 40 милливольт входном сигнале.

INA240A1PWR - 20 раз усиление. Похоже входное споротивление у неё 3 KOm (TSSOP-8_3x4.4x065P)

AD823 jfet amplifier 


Пускай у нас резистор 1 КОм, какой будет 1 uA сигнал?
AD8418 (INA240A1) усиливает в 20 раз, это будет 20 мВ.
У нас 19 бит на 3 вольта.
Получается аж 3000 отсчетов на микровольт! Правда максимальный ток измерения будет всего 150 uA. 10 ом - 15 ма (маловато будет!), надо будет ещё и 1 ом прикрутить видимо.

TMP112 около диода? Или ну его нафиг?

PA8 для выхода 8 МГц сигнала на ADC
Нужен ещё step up до +5V напряжения.
TPS61240DRVR - отлично подходит к нашей задаче

FT230XQ - подойдёт чтобы передавать наши данные

MAX12931 - как защита usb порта. - нет в LCSC
ISO7221BDR - нам вроде подходит

SSM3K345R,LF - подойдёт такой транзистор для переключения 1 Ом, остальные можно SI2302 переключать, впрочем можно и IRLML2502 использовать


- HLK-1D0505 изолированный преобразователь 200 мА
	слишком слабенький
 IB0505S-2W 400мА
 F0505S-2W 400мА
 Понятно, почему у них проблемма со стабильностью. На выходе там всеголишь пара диодов и все. Никакого feedback

 Как вариант взять ткмблер MTS-202 или MTS-203 чтобы подключаться к питанию

- резистор для TPS79301
- нарисовать USB через FT230XQ и ISO7221BDR

- резистор 1 Ом дольжен быть побольше
- проверить расположение UART разъёма по оси Y
- проверить расположение левой части коннекторов дисплея по оси X 


Что купить
FT230XQ     *
ISO7221BDR  *

INA240A1PW  *
ADS1251     *
TPS79301-EP *

Резисторы 0.1%
	1.2 Ом 0805 0.5% 25 ppm *
	10 Ом 0603 0.1%  *

	выводные 1 МОм 3 МОм 10 МОм *



Щупы входные
banana plug  - как вариант для щупов 
4 мм возможно неплохой вариант
https://aliexpress.ru/item/32323780790.html



- какие резисторы мы можем использовать, для 8 pF пина LCD экрана
	причина - МК питается от 3.3 вольта, а LCD от 3.0 вольта
	надо бы резисторы побольше, что-бы ток лишний не тек

	У нас частота 12 МГц, надо, чтобы зарядился до 90% за 20% времени?
	Попробуем резисторы 300 Ом R7-R12

- почти нет 
	22 pF
	22 Kom


- USB определяется
	/dev/ttyACM0

- глянуть, что 8 МГц сигнал есть --ok
- LCD дисплей для логов --ok
- написать софтварный драйвер для ADS1251
	- начали  писать, получили первые цифры
	- использовать hardware SPI --не получилось. SPI4 не поддерживает 24 бита

	- наш софтварный SPI работает со скоростью 7 микросекунд на 24 бита, т.е. 3 МГц
		ну и пускай пока так работает

SoftwareSPI24:
	push	{r4, r5}
	movs	r1, #24
	movs	r0, #0
	ldr	r2, .L15
	mov	r5, #4096
	mov	r4, #268435456
.L12:
	lsls	r0, r0, #1
	str	r5, [r2, #24]
	mov r0, r0
	mov r0, r0
	mov r0, r0
	ldr	r3, [r2, #16]
	subs	r1, r1, #1
	str	r4, [r2, #24]
	ubfx	r3, r3, #14, #1
	orr	r0, r0, r3
	bne	.L12

	pop	{r4, r5}
	bx	lr
	
.L15:
	.word	1476530176

